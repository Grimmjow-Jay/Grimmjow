package practice.demo;

import practice.util.Pair;

import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

/**
 * @author Jay Yang
 * @date 2023/5/8
 */
public class MergeSqlDemo {

    public static void main(String[] args) {

        List<String> lines = lines();

        Map<Pair<String, String>, List<String>> map = new LinkedHashMap<>();

        for (String line : lines) {
            String[] split = line.split(";");
            String price = split[0];
            String amount = split[1];
            String id = split[2];

            Pair<String, String> pair = new Pair<>(price, amount);
            List<String> ids = map.computeIfAbsent(pair, k -> new ArrayList<>());
            ids.add(id);
        }

        map.forEach((k, v) -> {
            String price = k.getKey();
            String amount = k.getValue();
            String ids = String.join(", ", v);

            System.out.println("update zc_finance.sku_cost_price_log set out_in_price = " + price + ", out_in_amount = " + amount + " where stock_detail_id in (" + ids + ");");
        });

    }

    private static List<String> lines() {
        List<String> sqls = new ArrayList<>();
        sqls.add("61.95;-247.8;1504759063457833421");
        sqls.add("464.17;-464.17;1504759063457833414");
        sqls.add("856.22;-282.5526;1504759063457833416");
        sqls.add("970.48;-320.2584;1504759063457833417");
        sqls.add("397.67;-795.34;1504759063457822892");
        sqls.add("397.67;-1193.01;1504759063457823366");
        sqls.add("281.45;-140.725;1504759063457823364");
        sqls.add("117.7;-117.7;1504759063457809645");
        sqls.add("117.7;-117.7;1504759063457809651");
        sqls.add("70.42;-70.42;1504759063457821039");
        sqls.add("70.42;-70.42;1504759063457822311");
        sqls.add("70.42;-70.42;1504759063457822319");
        sqls.add("70.42;-70.42;1504759063457822770");
        sqls.add("61.95;-123.9;1504759063457809625");
        sqls.add("61.95;-123.9;1504759063457809786");
        sqls.add("61.95;-123.9;1504759063457820218");
        sqls.add("61.95;-61.95;1504759063457820724");
        sqls.add("61.95;-61.95;1504759063457821951");
        sqls.add("61.95;-61.95;1504759063457822498");
        sqls.add("61.95;-61.95;1504759063457809721");
        sqls.add("61.95;-309.75;1504759063457819927");
        sqls.add("61.95;-185.85;1504759063457819925");
        sqls.add("61.95;-495.6;1504759063457820184");
        sqls.add("61.95;-61.95;1504759063457821717");
        sqls.add("61.95;-30.975;1504759063457822690");
        sqls.add("61.95;-61.95;1504759063457822720");
        sqls.add("61.95;-185.85;1504759063457822717");
        sqls.add("61.95;-61.95;1504759063457822708");
        sqls.add("61.95;-123.9;1504759063457822725");
        sqls.add("61.95;-61.95;1504759063457820612");
        sqls.add("61.95;-309.75;1504759063457821291");
        sqls.add("61.95;-123.9;1504759063457822151");
        sqls.add("61.95;-61.95;1504759063457822172");
        sqls.add("61.95;-61.95;1504759063457823296");
        sqls.add("61.95;-123.9;1504759063457823295");
        sqls.add("61.94;-185.82;1504759063457820681");
        sqls.add("61.94;-3097;1504759063457820680");
        sqls.add("61.94;-619.4;1504759063457820679");
        sqls.add("61.94;-371.64;1504759063457822412");
        sqls.add("61.95;-185.85;1504759063457809805");
        sqls.add("61.95;-61.95;1504759063457821050");
        sqls.add("61.95;-61.95;1504759063457821333");
        sqls.add("61.95;-247.8;1504759063457822350");
        sqls.add("61.99;-61.99;1504759063457820039");
        sqls.add("61.99;-61.99;1504759063457821778");
        sqls.add("61.99;-61.99;1504759063457821804");
        sqls.add("61.99;-123.98;1504759063457821817");
        sqls.add("61.99;-247.96;1504759063457821850");
        sqls.add("61.99;-309.95;1504759063457821865");
        sqls.add("61.99;-123.98;1504759063457821867");
        sqls.add("61.99;-61.99;1504759063457822527");
        sqls.add("61.95;-61.95;1504759063457820676");
        sqls.add("61.95;-123.9;1504759063457821368");
        sqls.add("61.95;-61.95;1504759063457822371");
        sqls.add("866.88;-866.88;1504759063457809702");
        sqls.add("814.63;-814.63;1504759063457820008");
        sqls.add("814.63;-1629.26;1504759063457820764");
        sqls.add("814.63;-814.63;1504759063457822369");
        sqls.add("814.63;-814.63;1504759063457822368");
        sqls.add("814.63;-814.63;1504759063457822370");
        sqls.add("814.63;-814.63;1504759063457822467");
        sqls.add("814.63;-814.63;1504759063457822736");
        sqls.add("814.63;-814.63;1504759063457822977");
        sqls.add("910.94;-455.47;1504759063457809797");
        sqls.add("910.94;-910.94;1504759063457822336");
        sqls.add("910.94;-455.47;1504759063457822838");
        sqls.add("889.48;-44.474;1504759063457820848");
        sqls.add("889.48;-889.48;1504759063457820847");
        sqls.add("889.48;-889.48;1504759063457821395");
        sqls.add("889.48;-889.48;1504759063457821415");
        sqls.add("889.48;-44.474;1504759063457822672");
        sqls.add("889.48;-889.48;1504759063457822671");
        sqls.add("889.48;-889.48;1504759063457822665");
        sqls.add("889.48;-44.474;1504759063457822663");
        sqls.add("201.22;-201.22;1504759063457809724");
        sqls.add("159.29;-796.45;1504759063457809627");
        sqls.add("159.29;-3982.25;1504759063457821593");
        sqls.add("159.29;-7486.63;1504759063457822641");
        sqls.add("159.29;-477.87;1504759063457822632");
        sqls.add("159.29;-4778.7;1504759063457822827");
        sqls.add("159.29;-15929;1504759063457822829");
        sqls.add("159.29;-7964.5;1504759063457823121");
        sqls.add("159.29;-796.45;1504759063457823313");
        sqls.add("159.29;-6371.6;1504759063457823324");
        sqls.add("173.52;-867.6;1504759063457822149");
        sqls.add("168.42;-336.84;1504759063457823283");
        sqls.add("160.67;-6.4268;1504759063457821611");
        sqls.add("160.67;-642.68;1504759063457822349");
        sqls.add("160.67;-160.67;1504759063457822338");
        sqls.add("160.67;-160.67;1504759063457822839");
        sqls.add("184.62;-923.1;1504759063457820653");
        sqls.add("184.62;-923.1;1504759063457821297");
        sqls.add("184.62;-369.24;1504759063457821346");
        sqls.add("184.62;-184.62;1504759063457821344");
        sqls.add("184.62;-923.1;1504759063457821359");
        sqls.add("184.62;-184.62;1504759063457821364");
        sqls.add("184.62;-738.48;1504759063457821363");
        sqls.add("184.62;-184.62;1504759063457821374");
        sqls.add("184.62;-369.24;1504759063457822377");
        sqls.add("184.62;-369.24;1504759063457822385");
        sqls.add("396.33;-3963.3;1504759063457820948");
        sqls.add("396.33;-396.33;1504759063457820978");
        sqls.add("396.33;-396.33;1504759063457820983");
        sqls.add("396.33;-1585.32;1504759063457820995");
        sqls.add("396.33;-1981.65;1504759063457821937");
        sqls.add("396.33;-1585.32;1504759063457822893");
        sqls.add("396.33;-396.33;1504759063457823097");
        sqls.add("396.33;-1188.99;1504759063457823367");
        sqls.add("238.94;-238.94;1504759063457822662");
        sqls.add("458.72;-1376.16;1504759063457821293");
        sqls.add("454.05;-454.05;1504759063457822529");
        sqls.add("449.54;-899.08;1504759063457822213");
        sqls.add("449.54;-224.77;1504759063457822228");
        sqls.add("449.54;-224.77;1504759063457822446");
        sqls.add("449.54;-8.9908;1504759063457822806");
        sqls.add("416.61;-416.61;1504759063457821792");
        sqls.add("685.49;-137.098;1504759063457809922");
        sqls.add("685.49;-137.098;1504759063457823221");
        sqls.add("685.49;-205.647;1504759063457823220");
        sqls.add("685.49;-205.647;1504759063457823244");
        sqls.add("969.5;-281.155;1504759063457822712");
        sqls.add("267.57;-88.2981;1504759063457821320");
        sqls.add("267.57;-133.785;1504759063457821655");
        sqls.add("259.84;-44.1728;1504759063457821718");
        sqls.add("259.84;-519.68;1504759063457822556");
        sqls.add("256.8;-256.8;1504759063457820246");
        sqls.add("256.8;-172.056;1504759063457821304");
        sqls.add("256.8;-256.8;1504759063457822849");
        sqls.add("258.74;-258.74;1504759063457821456");
        sqls.add("257.67;-257.67;1504759063457822862");
        sqls.add("258.56;-85.3248;1504759063457821978");
        sqls.add("258.56;-43.9552;1504759063457821999");
        sqls.add("257.31;-43.7427;1504759063457823151");
        sqls.add("257.31;-43.7427;1504759063457823204");
        sqls.add("257.31;-43.7427;1504759063457823203");
        sqls.add("445.6;-71.296;1504759063457820034");
        sqls.add("445.6;-445.6;1504759063457821800");
        sqls.add("441.26;-441.26;1504759063457809596");
        sqls.add("441.26;-441.26;1504759063457809655");
        sqls.add("441.26;-441.26;1504759063457822281");
        sqls.add("449.54;-449.54;1504759063457820890");
        sqls.add("449.54;-449.54;1504759063457821385");
        sqls.add("449.54;-449.54;1504759063457821617");
        sqls.add("449.54;-449.54;1504759063457822670");
        sqls.add("302.75;-302.75;1504759063457809941");
        sqls.add("337.91;-337.91;1504759063457809940");
        sqls.add("337.91;-2027.46;1504759063457821228");
        sqls.add("337.86;-3378.6;1504759063457820643");
        sqls.add("534;-1068;1504759063457820563");
        sqls.add("534;-534;1504759063457821816");
        sqls.add("534;-2670;1504759063457821834");
        sqls.add("534;-534;1504759063457821858");
        sqls.add("534;-3204;1504759063457822906");
        sqls.add("385.32;-5779.8;1504759063457809669");
        sqls.add("385.32;-65.5044;1504759063457809677");
        sqls.add("385.32;-11.5596;1504759063457822705");
        sqls.add("293.14;-293.14;1504759063457809906");
        sqls.add("293.14;-49.8338;1504759063457822002");
        sqls.add("152.03;-152.03;1504759063457822788");
        sqls.add("152.03;-152.03;1504759063457822799");
        sqls.add("163.01;-326.02;1504759063457822156");
        sqls.add("61.17;-61.17;1504759063457821907");
        sqls.add("26.55;-79.65;1504759063457820761");
        sqls.add("26.55;-106.2;1504759063457821558");
        sqls.add("26.55;-159.3;1504759063457822226");
        sqls.add("26.55;-53.1;1504759063457822747");
        sqls.add("26.55;-132.75;1504759063457821744");
        sqls.add("276.73;-276.73;1504759063457820240");
        sqls.add("276.73;-276.73;1504759063457821306");
        sqls.add("286.16;-572.32;1504759063457809601");
        sqls.add("286.16;-286.16;1504759063457809633");
        sqls.add("286.16;-572.32;1504759063457821443");
        sqls.add("286.16;-286.16;1504759063457821450");
        sqls.add("273.14;-546.28;1504759063457809996");
        sqls.add("273.14;-273.14;1504759063457810002");
        sqls.add("273.14;-273.14;1504759063457820437");
        sqls.add("273.14;-546.28;1504759063457820494");
        sqls.add("273.14;-273.14;1504759063457821150");
        sqls.add("273.14;-273.14;1504759063457821157");
        sqls.add("272.8;-545.6;1504759063457820863");
        sqls.add("272.8;-1364;1504759063457820873");
        sqls.add("272.8;-545.6;1504759063457822439");
        sqls.add("272.8;-272.8;1504759063457822660");
        sqls.add("272.8;-272.8;1504759063457822674");
        sqls.add("272.8;-272.8;1504759063457822843");
        sqls.add("260.77;-521.54;1504759063457822461");
        sqls.add("260.77;-260.77;1504759063457822474");
        sqls.add("123.89;-123.89;1504759063457822012");
        sqls.add("64.98;-3.8988;1504759063457820376");
        sqls.add("64.98;-16.245;1504759063457820403");
        sqls.add("64.98;-8.4474;1504759063457820402");
        sqls.add("64.98;-64.98;1504759063457821194");
        sqls.add("64.98;-64.98;1504759063457821244");
        sqls.add("64.98;-129.96;1504759063457823222");
        sqls.add("21.5;-430;1504759063457820001");
        sqls.add("21.5;-322.5;1504759063457821573");
        sqls.add("21.5;-21.5;1504759063457821576");
        sqls.add("21.5;-21.5;1504759063457822241");
        sqls.add("21.5;-43;1504759063457822476");
        sqls.add("21.5;-21.5;1504759063457822748");
        sqls.add("21.55;-1.0775;1504759063457822812");
        sqls.add("21.55;-1163.7;1504759063457822971");
        sqls.add("21.55;-991.3;1504759063457822970");
        sqls.add("21.56;-43.12;1504759063457809650");
        sqls.add("21.56;-21.56;1504759063457820060");
        sqls.add("21.56;-280.28;1504759063457820067");
        sqls.add("21.56;-43.12;1504759063457820652");
        sqls.add("21.56;-21.56;1504759063457822273");
        sqls.add("21.56;-215.6;1504759063457822283");
        sqls.add("21.56;-431.2;1504759063457822374");
        sqls.add("72.12;-144.24;1504759063457822860");
        sqls.add("65.49;-65.49;1504759063457821819");
        sqls.add("65.49;-130.98;1504759063457821840");
        sqls.add("65.49;-196.47;1504759063457821903");
        sqls.add("416.04;-416.04;1504759063457822372");
        sqls.add("391.92;-391.92;1504759063457821738");
        sqls.add("284.45;-284.45;1504759063457821562");
        sqls.add("284.45;-284.45;1504759063457822230");
        sqls.add("284.45;-568.9;1504759063457822983");
        sqls.add("284.43;-853.29;1504759063457809628");
        sqls.add("284.42;-2275.36;1504759063457822195");
        sqls.add("284.42;-568.84;1504759063457822205");
        sqls.add("284.42;-853.26;1504759063457822210");
        sqls.add("284.42;-1422.1;1504759063457822594");
        sqls.add("284.42;-568.84;1504759063457823123");
        sqls.add("284.42;-4266.3;1504759063457823125");
        sqls.add("284.42;-284.42;1504759063457823318");
        sqls.add("284.42;-1137.68;1504759063457823317");
        sqls.add("285.13;-285.13;1504759063457820574");
        sqls.add("285.13;-855.39;1504759063457821694");
        sqls.add("285.13;-855.39;1504759063457823373");
        sqls.add("279.76;-279.76;1504759063457820608");
        sqls.add("279.76;-279.76;1504759063457822148");
        sqls.add("274.51;-274.51;1504759063457821739");
        sqls.add("422.02;-422.02;1504759063457809781");
        sqls.add("422.02;-422.02;1504759063457819887");
        sqls.add("422.02;-422.02;1504759063457820212");
        sqls.add("422.02;-422.02;1504759063457820954");
        sqls.add("339.78;-339.78;1504759063457822721");
        sqls.add("422.02;-422.02;1504759063457820573");
        sqls.add("422.02;-1688.08;1504759063457821696");
        sqls.add("422.02;-2110.1;1504759063457823375");
        sqls.add("422.02;-422.02;1504759063457820546");
        sqls.add("422.02;-422.02;1504759063457822105");
        sqls.add("422.02;-422.02;1504759063457823205");
        sqls.add("222.95;-222.95;1504759063457820164");
        sqls.add("435.78;-130.734;1504759063457809678");
        sqls.add("435.78;-435.78;1504759063457820192");
        sqls.add("436.85;-436.85;1504759063457809802");
        sqls.add("436.85;-87.37;1504759063457822339");
        sqls.add("435.73;-174.292;1504759063457809901");
        sqls.add("435.73;-69.7168;1504759063457820346");
        sqls.add("435.73;-17.4292;1504759063457820345");
        sqls.add("435.73;-17.4292;1504759063457820525");
        sqls.add("435.73;-87.146;1504759063457822041");
        sqls.add("435.73;-435.73;1504759063457822096");
        sqls.add("435.73;-8.7146;1504759063457823238");
        sqls.add("123.92;-619.6;1504759063457821939");
        sqls.add("123.92;-743.52;1504759063457822890");
        sqls.add("123.92;-495.68;1504759063457823357");
        sqls.add("1013.41;-172.2797;1504759063457820083");
        sqls.add("1013.41;-172.2797;1504759063457820082");
        sqls.add("1013.41;-334.4253;1504759063457820109");
        sqls.add("1146.76;-1146.76;1504759063457822790");
        sqls.add("1146.76;-1146.76;1504759063457822786");
        sqls.add("1133.32;-192.6644;1504759063457820825");
        sqls.add("1133.32;-192.6644;1504759063457820826");
        sqls.add("1133.32;-566.66;1504759063457822217");
        sqls.add("1185.36;-201.5112;1504759063457821753");
        sqls.add("908.26;-154.4042;1504759063457810023");
        sqls.add("908.26;-154.4042;1504759063457820531");
        sqls.add("908.26;-908.26;1504759063457820511");
        sqls.add("908.26;-908.26;1504759063457821180");
        sqls.add("908.26;-154.4042;1504759063457821166");
        sqls.add("908.26;-154.4042;1504759063457821995");
        sqls.add("946.8;-946.8;1504759063457809668");
        sqls.add("946.8;-160.956;1504759063457820168");
        sqls.add("946.8;-160.956;1504759063457820167");
        sqls.add("946.8;-946.8;1504759063457822557");
        sqls.add("946.8;-312.444;1504759063457822682");
        sqls.add("946.8;-312.444;1504759063457822685");
        sqls.add("946.8;-312.444;1504759063457822701");
        sqls.add("963.31;1926.62;1504759063457822728");
        sqls.add("963.16;-963.16;1504759063457809758");
        sqls.add("963.16;-481.58;1504759063457809754");
        sqls.add("963.16;-481.58;1504759063457821288");
        sqls.add("963.16;-1926.32;1504759063457823278");
        sqls.add("964.56;-3858.24;1504759063457820046");
        sqls.add("964.56;-964.56;1504759063457820048");
        sqls.add("964.56;-4822.8;1504759063457821454");

        return sqls;
    }

}
